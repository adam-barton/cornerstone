{"components/products/extend-product-integration":"<script defer>\n    /*\n        @author : Extend\n        @version : 06.17.2021\n        \n        extend-product-integration.html\n        \n        This file handles variant changes for the product page\n    */\n\n\n    window.addEventListener('DOMContentLoaded', function(){\n\n        if (window.Extend && window.ExtendBigCommerce) {\n\n            function initProductOffer(modalProductId){\n\n                /************************/\n                /*  global variables   */\n                /***********************/\n                var productId;\n                {{#if page_type '===' 'product'}}\n                    productId = modalProductId ? modalProductId : {{{json product.id}}};\n                {{else}}\n                    productId = modalProductId;\n                {{/if}}\n                var storefrontApiToken = {{{json settings.storefront_api.token}}}\n                var modalContent = document.querySelector('#modal .modal-content');\n\n                var $productOptionsElement = modalProductId ? modalContent.querySelector('[data-product-option-change]') : document.querySelector('[data-product-option-change]');\n                var extendOffer = modalProductId ? modalContent.querySelector('#extend-offer') : document.querySelector('#extend-offer');\n\n                var slice = Array.prototype.slice;\n\n                /************************/\n                /*    util functions   */\n                /***********************/\n\n                // findAll function handles browser compatability issues for querySelectorAll\n                function findAll(element) {\n                    var items = document.querySelectorAll(element);\n                    return items ? slice.call(items, 0) : [];\n                }\n\n                //Only continue if we have required variables\n                if(productId && storefrontApiToken){\n\n                    // ExtendBigCommerce.getProductById(productId, storefrontApiToken)\n                    // Gets product by id, and listens for select change to update variant \n                    ExtendBigCommerce.getProductById({\n                        productId,\n                        storefrontApiToken,\n                        done: function(err, result) {\n\n                            //Find current product node\n                            var currentProductNode = result.data.site.products.edges.find(it => String(it.node.entityId) === productId);\n\n                            //select variants, and initial sku from variants (first variant)\n                            var productVariants = currentProductNode.node.variants.edges;\n                            let sku =  productVariants[0].node.sku;\n\n                            //Render initial PDP offers with the SKU\n                            Extend.buttons.render(extendOffer, {referenceId: sku});\n                            \n                        }\n                    })\n                }\n            }\n            window.initProductOffer = initProductOffer;\n        }\n    })\n\n</script>\n\n<style>\n\n    #extend-offer {\n        padding-left: 5px;\n    }\n\n</style>\n"}
